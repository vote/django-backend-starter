dist: bionic
language: python
python:
  - "3.8"

services:
  - docker

env:
  DOCKER_OPTS="${DOCKER_OPTS} --registry-mirror=https://mirror.gcr.io"

before_install:
  - touch .env
  - mkdir ~/.docker
  - cat <<< $(jq '.+{"registry-mirrors":["https://mirror.gcr.io"]}' ~/.docker/config.json) > ~/.docker/config.json

install:
  - docker-compose build

before_script:
  - docker-compose up -d

script:
  # Put test code here
  - docker-compose exec server pipenv run mypy /app/

notifications:
  email: false
